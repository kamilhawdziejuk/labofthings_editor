<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
      <script type="text/javascript" src="jquery-1.7.1.js"></script>
      <script type="text/javascript" src="common.js"></script>
      <script type="text/javascript" src="DashboardWebJavascript.js"></script>
      <script type="text/javascript" src="homeos-1.1.js"></script>
  <link rel="stylesheet" media="all" type="text/css" href="Styles/HomeOSMasterStyleSheet.css" />
    <meta charset="utf-8" />
    <title></title>

    <script>
        $(document).ready(function () {
            Init();
        });

        function Init() {
            new PlatformServiceHelper().MakeServiceCall("webapp/GetAppNamesWeb", "", FillAppNamesCallback);
        }

        function FillAppNamesCallback(context, result) {
            $("#modules1Id").empty();
            $("#modules2Id").empty();
            for (var i = 0; i < result.length; i++) {
                var optionData = '<option value="' + result[i] + '">' + result[i] + '</option>';
                $("#modules1Id").append(optionData);
                $("#modules2Id").append(optionData);
            }
        }

        function FillStates1() {
            var selectBox = document.getElementById("modules1Id");
            var selectedValue = selectBox.options[selectBox.selectedIndex].value;
            var parameters = '{"name":"' + selectedValue + '"}';
            new PlatformServiceHelper().MakeServiceCall("webapp/GetModuleStatesWeb", parameters, FillStatesCallback1);
        }

        function FillStates2() {
            var selectBox = document.getElementById("modules1Id");
            var selectedValue = selectBox.options[selectBox.selectedIndex].value;
            var parameters = '{"name":"' + selectedValue + '"}';
            new PlatformServiceHelper().MakeServiceCall("webapp/GetModuleStatesWeb", parameters, FillStatesCallback2);
        }

        function FillStatesCallback1(context, result) {
            $("#states1Id").empty();
            for (var i = 0; i < result.length; i++) {
                $("#states1Id").append('<option value="' + result[i] + '">' + result[i] + '</option>');
            }
        }

        function FillStatesCallback2(context, result) {
            $("#states2Id").empty();
            for (var i = 0; i < result.length; i++) {
                $("#states2Id").append('<option value="' + result[i] + '">' + result[i] + '</option>');
            }
        }
    </script>

</head>
<body>
        <div><h2>Home Environment -> Editor2</h2></div>
        <button onsubmit="Init()">Initialize</button>
    <img src="SmartHouse.jpg" width="500" />

    <div> 
        <h3>* Rules defining</h3>
        WHEN module 
        <select name="Modules" id="modules1Id" onchange="FillStates1();" />
        is in state
       <select name="State" id="states1Id" />
        THEN activate module 
        <select name="Modules2" id="modules2Id" onchange="FillStates1();" />
        to state
       <select name="State2" id="states2Id" />
    </div>
        <button>Save</button>
    <div>
        
    </div>

    <hr />
        <h3>* Rules detecting</h3>
    Write your expectation rule (ex. "When user enters a house then turn lights on"):     <textarea rows="2" cols="50"></textarea>
    <br />
    <span id="testId" ></span>

</body>
</html>